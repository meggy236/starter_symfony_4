UserMutation:
    decorator: true
    heirs: [Mutation]
    config:
        fields:
            UpdateUser:
                type: UserMutationPayload!
                public: '@=isAuthenticated()'
                access: '@=isAuthenticated()'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\UserUpdateMutation", [args])'
                args:
                    user: UserUpdateInput!

            ChangePassword:
                type: UserMutationPayload!
                public: '@=isAuthenticated()'
                access: '@=isAuthenticated()'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\UserPasswordMutation", [args])'
                args:
                    user: UserPasswordInput!

            UserRecoverInitiate:
                type: UserResultPayload!
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\UserRecoverInitiateMutation", [args])'
                args:
                    email: String!

            UserRecoverReset:
                type: UserResultPayload!
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\UserRecoverResetMutation", [args])'
                args:
                    token: String!
                    newPassword: String!
                    repeatPassword: String!

            UserVerify:
                type: UserResultPayload!
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\UserRecoverResetMutation", [args])'
                args:
                    token: String!
                    newPassword: String!
                    repeatPassword: String!

            AdminCreateUser:
                type: AdminUserMutationPayload!
                public: '@=hasRole("ROLE_ADMIN")'
                access: '@=hasRole("ROLE_ADMIN")'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\AdminUserCreateMutation", [args])'
                args:
                    user: AdminUserCreateInput!

            AdminUpdateUser:
                type: AdminUserMutationPayload!
                public: '@=hasRole("ROLE_ADMIN")'
                access: '@=hasRole("ROLE_ADMIN")'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\AdminUserUpdateMutation", [args])'
                args:
                    user: AdminUserUpdateInput!

            AdminActivateUser:
                type: AdminUserMutationPayload!
                public: '@=hasRole("ROLE_ADMIN")'
                access: '@=hasRole("ROLE_ADMIN")'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\AdminUserActivateMutation", [args])'
                args:
                    user: AdminUserActivateInput!

            AdminVerifyUser:
                type: AdminUserMutationPayload!
                public: '@=hasRole("ROLE_ADMIN")'
                access: '@=hasRole("ROLE_ADMIN")'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\AdminUserVerifyMutation", [args])'
                args:
                    user: AdminUserInput!

            AdminSendResetToUser:
                type: AdminUserMutationPayload!
                public: '@=hasRole("ROLE_ADMIN")'
                access: '@=hasRole("ROLE_ADMIN")'
                resolve: '@=mutation("App\\Infrastructure\\GraphQl\\Mutation\\AdminUserSendResetToUserMutation", [args])'
                args:
                    user: AdminUserInput!

# @todo check if these are publicly access; do we care?

UserUpdateInput:
    type: input-object
    config:
        description: 'User update mutation input.'
        fields:
            email:
                type: String!
            firstName:
                type: String!
            lastName:
                type: String!

UserPasswordInput:
    type: input-object
    config:
        description: 'User update mutation input.'
        fields:
            currentPassword:
                type: String!
            newPassword:
                type: String!
            repeatPassword:
                type: String!

AdminUserCreateInput:
    type: input-object
    config:
        description: 'Admin User create mutation input.'
        fields:
            id:
                type: UUID!
            email:
                type: String!
            setPassword:
                type: Boolean!
            password:
                type: String
            role:
                type: Role!
            active:
                type: Boolean!
            firstName:
                type: String!
            lastName:
                type: String!
            sendInvite:
                type: Boolean!

AdminUserUpdateInput:
    type: input-object
    config:
        description: 'Admin User update mutation input.'
        fields:
            id:
                type: UUID!
            email:
                type: String!
            changePassword:
                type: Boolean!
            password:
                type: String
            role:
                type: Role!
            firstName:
                type: String!
            lastName:
                type: String!

AdminUserActivateInput:
    type: input-object
    config:
        description: 'Admin User activate/deactivate mutation input.'
        fields:
            id:
                type: UUID!
            action:
                type: String!

AdminUserInput:
    type: input-object
    config:
        description: 'Admin User mutation input.'
        fields:
            id:
                type: UUID!

UserMutationPayload:
    type: object
    config:
        description: 'User mutation payload.'
        fields:
            id:
                type: UUID!

UserResultPayload:
    type: object
    config:
        description: 'Payload if the User mutation was successful.'
        fields:
            success:
                type: Boolean!

AdminUserMutationPayload:
    type: object
    config:
        description: 'Admin User mutation payload.'
        fields:
            id:
                type: UUID!
